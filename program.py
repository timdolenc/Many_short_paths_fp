from copy import deepcopy
import re
import sys
import pandas as pd
import matplotlib.pyplot as plt
import json
import re
import numpy as np
import os


sez_sosedov = [ #graf s predavanj z lihim ciklom
    [1,4],
    [0,5],
    [3,5,6],
    [2,7],
    [0],
    [1,2,6],
    [2,5,7],
    [3,6],
]
    


def vse_pk_iz_v(G, v, k, length=False):
    """vrne seznam vseh 'navadnih' podgrafov G (predstavljenim s sez. sosedov), 
    ki so kopija Pk in se začnejo v v.
    Argumenti:
     - G ... seznam sosedov,
     - v ... začetno vozlišče
     - lenght ... True, če naj funkcija vrne samo število najdenih poti, sicer vrne seznam vseh poti. 
    """
    poti = [[v]]            #iskan seznam vseh poti iz v
    for _ in range(k):      #želimo prehoditi pot dolžine k, zato postopek ponovimo k-krat
        vse_nove_poti = []  #ustvarimo nov seznam da ne pokvarimo starega
        for pot in poti:    
            v = pot[-1]      #zadnji element poti postane nov koren (v)
            nove_poti = []     #nove_poti so poti, ki so nadaljevanje spremenljivke pot, torej imajo pri npr. k=2 že dva fiksna elementa
            for sosed in G[v]:    #pogledamo vse sosede v-ja    
                if sosed not in pot: 
                    nova_pot = pot + [sosed] #če sosed še ni element trenutne poti ga dodamo na konec ene izmed novo ustvarjenih poti (za vsakega ustreznega soseda dobimo novo)
                    nove_poti.append(nova_pot) #novo pot dodamo k novim potem
            vse_nove_poti = vse_nove_poti + nove_poti #tako najdene poti z dodajanjem enega posameznega
        poti = vse_nove_poti #šele na koncu updatamo občutljiv seznam "poti"
    if length:
        return len(poti)
    else:
        return poti

def vse_pk(G, k, length=True):
    """fi(G,k), funkcija za poljuben graf G (sez sosedov) in vsako
    njegovo vozlišče v poišče kopije Pk ki se začnejo (ali končajo) v v
    in naredi njihovo unijo"""
    vse = []
    for v in range(len(G)): #iterira čez vozlišča G
        for pot in vse_pk_iz_v(G,v,k,length=False): 
            if pot[::-1] not in vse and pot not in vse: #preverimo, če je pot v katerem koli vrstnem redu že vsebovana v seznamu
                vse.append(pot) #če ni, jo dodamo med iskan seznam
    if length:
        return len(vse) 
    return vse

def vse_inducirane_pk(G, k, length=True): 
    """ fi_i(G,k)
    vrne število induciranih podgrafov izomorfnih Pk, na način
    da za vsak Pk-ju izomorfen podgraf G-ja preveri ali je induciran.
    """
    ustrezne_poti = deepcopy(vse_pk(G,k,length=False)) 
    for pot in vse_pk(G,k,length=False):
        for u in pot:
            for v in pot:  
                if u in G[v] and abs(pot.index(u)-pot.index(v)) != 1: 
                    ustrezne_poti.remove(pot) #odstranimo poti, ki vsebujejo vozlišča u,v ki v poti nista sosednja, v G pa sta
                    break 
            if u in G[v] and abs(pot.index(u)-pot.index(v)) != 1: #dvakrat isti pogoj, da pademo iz dveh notranjih for zank, ko pot ostranimo
                break
                
    if length:
        return len(ustrezne_poti) 
    return ustrezne_poti

def fi(G,k):
    return vse_pk(G,k)

def fi_i(G,k):
    return vse_inducirane_pk(G,k)




#HIPERKOCKA
def razdalja_med_nizoma(a, b): #ta funkcija je splošnejša, kot kar rabimo za naše potrebe
    if len(a) > len(b): # a je vedno takrajši
        a, b = b, a
    if a == "":
        return len(b)
    return int(a[0]!=b[0]) + razdalja_med_nizoma(a[1:], b[1:])
 
def vse_binarne_permutacije(št_dimenzij):
    if št_dimenzij == 1:
        return ["0", "1"]
    z_nič = ["0" + permutacija for permutacija in vse_binarne_permutacije(št_dimenzij-1)] 
    z_ena = ["1" + permutacija for permutacija in vse_binarne_permutacije(št_dimenzij-1)]
    return z_nič + z_ena

def v_desetiškem(niz):
    if len(niz) == 1:
        return int(niz)
    stopnja = len(niz)-1
    vr = 2 ** stopnja
    return int(niz[0])*vr + v_desetiškem(niz[1:])

                
def hiperkocka(št_dimenzij):
    hiperkocka = [[] for _ in range(2**št_dimenzij)]
    vozlišča_v_binarnem = vse_binarne_permutacije(št_dimenzij)
    videni = []
    for u in vozlišča_v_binarnem:
        for v in vozlišča_v_binarnem:
            if {u,v} in videni:
                continue
            if razdalja_med_nizoma(u,v) == 1:
                vozl1 = v_desetiškem(u)
                vozl2 = v_desetiškem(v)
                hiperkocka[vozl1].append(vozl2)
                hiperkocka[vozl2].append(vozl1)
                videni.append({u,v})
    return hiperkocka




    



def dataframe_fi(sez_grafov_po_n, max_k):
    df = pd.DataFrame()
    for i, graf in enumerate(sez_grafov_po_n):
        stolpec = [fi(graf,k) for k in range(1, max_k+1)]
        n = i+1
        df[f"n = {n}"] = stolpec
    df = df.rename(index = lambda x: f"k = {x+1}")
    return df

  
def dataframe_fi_i(sez_grafov_po_n, max_k):
    df = pd.DataFrame()
    for i, graf in enumerate(sez_grafov_po_n):
        stolpec = [fi_i(graf,k) for k in range(1, max_k+1)]
        n = i+1
        df[f"n = {n}"] = stolpec
    df = df.rename(index = lambda x: f"k = {x+1} |")
    return df



#hiperkocke = [hiperkocka(n) for n in range(1,10)]
hiperkocke_9 = [[[1], [0]], [[1, 2], [0, 3], [0, 3], [1, 2]], [[1, 2, 4], [0, 3, 5], [0, 3, 6], [1, 2, 7], [0, 5, 6], [1, 4, 7], [2, 4, 7], [3, 5, 6]], [[1, 2, 4, 8], [0, 3, 5, 9], [0, 3, 6, 10], [1, 2, 7, 11], [0, 5, 6, 12], [1, 4, 7, 13], [2, 4, 7, 14], [3, 5, 6, 15], [0, 9, 10, 12], [1, 8, 11, 13], [2, 8, 11, 14], [3, 9, 10, 15], [4, 8, 13, 14], [5, 9, 12, 15], [6, 10, 12, 15], [7, 11, 13, 14]], [[1, 2, 4, 8, 16], [0, 3, 5, 9, 17], [0, 3, 6, 10, 18], [1, 2, 7, 11, 19], [0, 5, 6, 12, 20], [1, 4, 7, 13, 21], [2, 4, 7, 14, 22], [3, 5, 6, 15, 23], [0, 9, 10, 12, 24], [1, 8, 11, 13, 25], [2, 8, 11, 14, 26], [3, 9, 10, 15, 27], [4, 8, 13, 14, 28], [5, 9, 12, 15, 29], [6, 10, 12, 15, 30], [7, 11, 13, 14, 31], [0, 17, 18, 20, 24], [1, 16, 19, 21, 25], [2, 16, 19, 22, 26], [3, 17, 18, 23, 27], [4, 16, 21, 22, 28], [5, 17, 20, 23, 29], [6, 18, 20, 23, 30], [7, 19, 21, 22, 31], [8, 16, 25, 26, 28], [9, 17, 24, 27, 29], [10, 18, 24, 27, 30], [11, 19, 25, 26, 31], [12, 20, 24, 29, 30], [13, 21, 25, 28, 31], [14, 22, 26, 28, 31], [15, 23, 27, 29, 30]], [[1, 2, 4, 8, 16, 32], [0, 3, 5, 9, 17, 33], [0, 3, 6, 10, 18, 34], [1, 2, 7, 11, 19, 35], [0, 5, 6, 12, 20, 36], [1, 4, 7, 13, 21, 37], [2, 4, 7, 14, 22, 38], [3, 5, 6, 15, 23, 39], [0, 9, 10, 12, 24, 40], [1, 8, 11, 13, 25, 41], [2, 8, 11, 14, 26, 42], [3, 9, 10, 15, 27, 43], [4, 8, 13, 14, 28, 44], [5, 9, 12, 15, 29, 45], [6, 10, 12, 15, 30, 46], [7, 11, 13, 14, 31, 47], [0, 17, 18, 20, 24, 48], [1, 16, 19, 21, 25, 49], [2, 16, 19, 22, 26, 50], [3, 17, 18, 23, 27, 51], [4, 16, 21, 22, 28, 52], [5, 17, 20, 23, 29, 53], [6, 18, 20, 23, 30, 54], [7, 19, 21, 22, 31, 55], [8, 16, 25, 26, 28, 56], [9, 17, 24, 27, 29, 57], [10, 18, 24, 27, 30, 58], [11, 19, 25, 26, 31, 59], [12, 20, 24, 29, 30, 60], [13, 21, 25, 28, 31, 61], [14, 22, 26, 28, 31, 62], [15, 23, 27, 29, 30, 63], [0, 33, 34, 36, 40, 48], [1, 32, 35, 37, 41, 49], [2, 32, 35, 38, 42, 50], [3, 33, 34, 39, 43, 51], [4, 32, 37, 38, 44, 52], [5, 33, 36, 39, 45, 53], [6, 34, 36, 39, 46, 54], [7, 35, 37, 38, 47, 55], [8, 32, 41, 42, 44, 56], [9, 33, 40, 43, 45, 57], [10, 34, 40, 43, 46, 58], [11, 35, 41, 42, 47, 59], [12, 36, 40, 45, 46, 60], [13, 37, 41, 44, 47, 61], [14, 38, 42, 44, 47, 62], [15, 39, 43, 45, 46, 63], [16, 32, 49, 50, 52, 56], [17, 33, 48, 51, 53, 57], [18, 34, 48, 51, 54, 58], [19, 35, 49, 50, 55, 59], [20, 36, 48, 53, 54, 60], [21, 37, 49, 52, 55, 61], [22, 38, 50, 52, 55, 62], [23, 39, 51, 53, 54, 63], [24, 40, 48, 57, 58, 60], [25, 41, 49, 56, 59, 61], [26, 42, 50, 56, 59, 62], [27, 43, 51, 57, 58, 63], [28, 44, 52, 56, 61, 62], [29, 45, 53, 57, 60, 63], [30, 46, 54, 58, 60, 63], [31, 47, 55, 59, 61, 62]], [[1, 2, 4, 8, 16, 32, 64], [0, 3, 5, 9, 17, 33, 65], [0, 3, 6, 10, 18, 34, 66], [1, 2, 7, 11, 19, 35, 67], [0, 5, 6, 12, 20, 36, 68], [1, 4, 7, 13, 21, 37, 69], [2, 4, 7, 14, 22, 38, 70], [3, 5, 6, 15, 23, 39, 71], [0, 9, 10, 12, 24, 40, 72], [1, 8, 11, 13, 25, 41, 73], [2, 8, 11, 14, 26, 42, 74], [3, 9, 10, 15, 27, 43, 75], [4, 8, 13, 14, 28, 44, 76], [5, 9, 12, 15, 29, 45, 77], [6, 10, 12, 15, 30, 46, 78], [7, 11, 13, 14, 31, 47, 79], [0, 17, 18, 20, 24, 48, 80], [1, 16, 19, 21, 25, 49, 81], [2, 16, 19, 22, 26, 50, 82], [3, 17, 18, 23, 27, 51, 83], [4, 16, 21, 22, 28, 52, 84], [5, 17, 20, 23, 29, 53, 85], [6, 18, 20, 23, 30, 54, 86], [7, 19, 21, 22, 31, 55, 87], [8, 16, 25, 26, 28, 56, 88], [9, 17, 24, 27, 29, 57, 89], [10, 18, 24, 27, 30, 58, 90], [11, 19, 25, 26, 31, 59, 91], [12, 20, 24, 29, 30, 60, 92], [13, 21, 25, 28, 31, 61, 93], [14, 22, 26, 28, 31, 62, 94], [15, 23, 27, 29, 30, 63, 95], [0, 33, 34, 36, 40, 48, 96], [1, 32, 35, 37, 41, 49, 97], [2, 32, 35, 38, 42, 50, 98], [3, 33, 34, 39, 43, 51, 99], [4, 32, 37, 38, 44, 52, 100], [5, 33, 36, 39, 45, 53, 101], [6, 34, 36, 39, 46, 54, 102], [7, 35, 37, 38, 47, 55, 103], [8, 32, 41, 42, 44, 56, 104], [9, 33, 40, 43, 45, 57, 105], [10, 34, 40, 43, 46, 58, 106], [11, 35, 41, 42, 47, 59, 107], [12, 36, 40, 45, 46, 60, 108], [13, 37, 41, 44, 47, 61, 109], [14, 38, 42, 44, 47, 62, 110], [15, 39, 43, 45, 46, 63, 111], [16, 32, 49, 50, 52, 56, 112], [17, 33, 48, 51, 53, 57, 113], [18, 34, 48, 51, 54, 58, 114], [19, 35, 49, 50, 55, 59, 115], [20, 36, 48, 53, 54, 60, 116], [21, 37, 49, 52, 55, 61, 117], [22, 38, 50, 52, 55, 62, 118], [23, 39, 51, 53, 54, 63, 119], [24, 40, 48, 57, 58, 60, 120], [25, 41, 49, 56, 59, 61, 121], [26, 42, 50, 56, 59, 62, 122], [27, 43, 51, 57, 58, 63, 123], [28, 44, 52, 56, 61, 62, 124], [29, 45, 53, 57, 60, 63, 125], [30, 46, 54, 58, 60, 63, 126], [31, 47, 55, 59, 61, 62, 127], [0, 65, 66, 68, 72, 80, 96], [1, 64, 67, 69, 73, 81, 97], [2, 64, 67, 70, 74, 82, 98], [3, 65, 66, 71, 75, 83, 99], [4, 64, 69, 70, 76, 84, 100], [5, 65, 68, 71, 77, 85, 101], [6, 66, 68, 71, 78, 86, 102], [7, 67, 69, 70, 79, 87, 103], [8, 64, 73, 74, 76, 88, 104], [9, 65, 72, 75, 77, 89, 105], [10, 66, 72, 75, 78, 90, 106], [11, 67, 73, 74, 79, 91, 107], [12, 68, 72, 77, 78, 92, 108], [13, 69, 73, 76, 79, 93, 109], [14, 70, 74, 76, 79, 94, 110], [15, 71, 75, 77, 78, 95, 111], [16, 64, 81, 82, 84, 88, 112], [17, 65, 80, 83, 85, 89, 113], [18, 66, 80, 83, 86, 90, 114], [19, 67, 81, 82, 87, 91, 115], [20, 68, 80, 85, 86, 92, 116], [21, 69, 81, 84, 87, 93, 117], [22, 70, 82, 84, 87, 94, 118], [23, 71, 83, 85, 86, 95, 119], [24, 72, 80, 89, 90, 92, 120], [25, 73, 81, 88, 91, 93, 121], [26, 74, 82, 88, 91, 94, 122], [27, 75, 83, 89, 90, 95, 123], [28, 76, 84, 88, 93, 94, 124], [29, 77, 85, 89, 92, 95, 125], [30, 78, 86, 90, 92, 95, 126], [31, 79, 87, 91, 93, 94, 127], [32, 64, 97, 98, 100, 104, 112], [33, 65, 96, 99, 101, 105, 113], [34, 66, 96, 99, 102, 106, 114], [35, 67, 97, 98, 103, 107, 115], [36, 68, 96, 101, 102, 108, 116], [37, 69, 97, 100, 103, 109, 117], [38, 70, 98, 100, 103, 110, 118], [39, 71, 99, 101, 102, 111, 119], [40, 72, 96, 105, 106, 108, 120], [41, 73, 97, 104, 107, 109, 121], [42, 74, 98, 104, 107, 110, 122], [43, 75, 99, 105, 106, 111, 123], [44, 76, 100, 104, 109, 110, 124], [45, 77, 101, 105, 108, 111, 125], [46, 78, 102, 106, 108, 111, 126], [47, 79, 103, 107, 109, 110, 127], [48, 80, 96, 113, 114, 116, 120], [49, 81, 97, 112, 115, 117, 121], [50, 82, 98, 112, 115, 118, 122], [51, 83, 99, 113, 114, 119, 123], [52, 84, 100, 112, 117, 118, 124], [53, 85, 101, 113, 116, 119, 125], [54, 86, 102, 114, 116, 119, 126], [55, 87, 103, 115, 117, 118, 127], [56, 88, 104, 112, 121, 122, 124], [57, 89, 105, 113, 120, 123, 125], [58, 90, 106, 114, 120, 123, 126], [59, 91, 107, 115, 121, 122, 127], [60, 92, 108, 116, 120, 125, 126], [61, 93, 109, 117, 121, 124, 127], [62, 94, 110, 118, 122, 124, 127], [63, 95, 111, 119, 123, 125, 126]], [[1, 2, 4, 8, 16, 32, 64, 128], [0, 3, 5, 9, 17, 33, 65, 129], [0, 3, 6, 10, 18, 34, 66, 130], [1, 2, 7, 11, 19, 35, 67, 131], [0, 5, 6, 12, 20, 36, 68, 132], [1, 4, 7, 13, 21, 37, 69, 133], [2, 4, 7, 14, 22, 38, 70, 134], [3, 5, 6, 15, 23, 39, 71, 135], [0, 9, 10, 12, 24, 40, 72, 136], [1, 8, 11, 13, 25, 41, 73, 137], [2, 8, 11, 14, 26, 42, 74, 138], [3, 9, 10, 15, 27, 43, 75, 139], [4, 8, 13, 14, 28, 44, 76, 140], [5, 9, 12, 15, 29, 45, 77, 141], [6, 10, 12, 15, 30, 46, 78, 142], [7, 11, 13, 14, 31, 47, 79, 143], [0, 17, 18, 20, 24, 48, 80, 144], [1, 16, 19, 21, 25, 49, 81, 145], [2, 16, 19, 22, 26, 50, 82, 146], [3, 17, 18, 23, 27, 51, 83, 147], [4, 16, 21, 22, 28, 52, 84, 148], [5, 17, 20, 23, 29, 53, 85, 149], [6, 18, 20, 23, 30, 54, 86, 150], [7, 19, 21, 22, 31, 55, 87, 151], [8, 16, 25, 26, 28, 56, 88, 152], [9, 17, 24, 27, 29, 57, 89, 153], [10, 18, 24, 27, 30, 58, 90, 154], [11, 19, 25, 26, 31, 59, 91, 155], [12, 20, 24, 29, 30, 60, 92, 156], [13, 21, 25, 28, 31, 61, 93, 157], [14, 22, 26, 28, 31, 62, 94, 158], [15, 23, 27, 29, 30, 63, 95, 159], [0, 33, 34, 36, 40, 48, 96, 160], [1, 32, 35, 37, 41, 49, 97, 161], [2, 32, 35, 38, 42, 50, 98, 162], [3, 33, 34, 39, 43, 51, 99, 163], [4, 32, 37, 38, 44, 52, 100, 164], [5, 33, 36, 39, 45, 53, 101, 165], [6, 34, 36, 39, 46, 54, 102, 166], [7, 35, 37, 38, 47, 55, 103, 167], [8, 32, 41, 42, 44, 56, 104, 168], [9, 33, 40, 43, 45, 57, 105, 169], [10, 34, 40, 43, 46, 58, 106, 170], [11, 35, 41, 42, 47, 59, 107, 171], [12, 36, 40, 45, 46, 60, 108, 172], [13, 37, 41, 44, 47, 61, 109, 173], [14, 38, 42, 44, 47, 62, 110, 174], [15, 39, 43, 45, 46, 63, 111, 175], [16, 32, 49, 50, 52, 56, 112, 176], [17, 33, 48, 51, 53, 57, 113, 177], [18, 34, 48, 51, 54, 58, 114, 178], [19, 35, 49, 50, 55, 59, 115, 179], [20, 36, 48, 53, 54, 60, 116, 180], [21, 37, 49, 52, 55, 61, 117, 181], [22, 38, 50, 52, 55, 62, 118, 182], [23, 39, 51, 53, 54, 63, 119, 183], [24, 40, 48, 57, 58, 60, 120, 184], [25, 41, 49, 56, 59, 61, 121, 185], [26, 42, 50, 56, 59, 62, 122, 186], [27, 43, 51, 57, 58, 63, 123, 187], [28, 44, 52, 56, 61, 62, 124, 188], [29, 45, 53, 57, 60, 63, 125, 189], [30, 46, 54, 58, 60, 63, 126, 190], [31, 47, 55, 59, 61, 62, 127, 191], [0, 65, 66, 68, 72, 80, 96, 192], [1, 64, 67, 69, 73, 81, 97, 193], [2, 64, 67, 70, 74, 82, 98, 194], [3, 65, 66, 71, 75, 83, 99, 195], [4, 64, 69, 70, 76, 84, 100, 196], [5, 65, 68, 71, 77, 85, 101, 197], [6, 66, 68, 71, 78, 86, 102, 198], [7, 67, 69, 70, 79, 87, 103, 199], [8, 64, 73, 74, 76, 88, 104, 200], [9, 65, 72, 75, 77, 89, 105, 201], [10, 66, 72, 75, 78, 90, 106, 202], [11, 67, 73, 74, 79, 91, 107, 203], [12, 68, 72, 77, 78, 92, 108, 204], [13, 69, 73, 76, 79, 93, 109, 205], [14, 70, 74, 76, 79, 94, 110, 206], [15, 71, 75, 77, 78, 95, 111, 207], [16, 64, 81, 82, 84, 88, 112, 208], [17, 65, 80, 83, 85, 89, 113, 209], [18, 66, 80, 83, 86, 90, 114, 210], [19, 67, 81, 82, 87, 91, 115, 211], [20, 68, 80, 85, 86, 92, 116, 212], [21, 69, 81, 84, 87, 93, 117, 213], [22, 70, 82, 84, 87, 94, 118, 214], [23, 71, 83, 85, 86, 95, 119, 215], [24, 72, 80, 89, 90, 92, 120, 216], [25, 73, 81, 88, 91, 93, 121, 217], [26, 74, 82, 88, 91, 94, 122, 218], [27, 75, 83, 89, 90, 95, 123, 219], [28, 76, 84, 88, 93, 94, 124, 220], [29, 77, 85, 89, 92, 95, 125, 221], [30, 78, 86, 90, 92, 95, 126, 222], [31, 79, 87, 91, 93, 94, 127, 223], [32, 64, 97, 98, 100, 104, 112, 224], [33, 65, 96, 99, 101, 105, 113, 225], [34, 66, 96, 99, 102, 106, 114, 226], [35, 67, 97, 98, 103, 107, 115, 227], [36, 68, 96, 101, 102, 108, 116, 228], [37, 69, 97, 100, 103, 109, 117, 229], [38, 70, 98, 100, 103, 110, 118, 230], [39, 71, 99, 101, 102, 111, 119, 231], [40, 72, 96, 105, 106, 108, 120, 232], [41, 73, 97, 104, 107, 109, 121, 233], [42, 74, 98, 104, 107, 110, 122, 234], [43, 75, 99, 105, 106, 111, 123, 235], [44, 76, 100, 104, 109, 110, 124, 236], [45, 77, 101, 105, 108, 111, 125, 237], [46, 78, 102, 106, 108, 111, 126, 238], [47, 79, 103, 107, 109, 110, 127, 239], [48, 80, 96, 113, 114, 116, 120, 240], [49, 81, 97, 112, 115, 117, 121, 241], [50, 82, 98, 112, 115, 118, 122, 242], [51, 83, 99, 113, 114, 119, 123, 243], [52, 84, 100, 112, 117, 118, 124, 244], [53, 85, 101, 113, 116, 119, 125, 245], [54, 86, 102, 114, 116, 119, 126, 246], [55, 87, 103, 115, 117, 118, 127, 247], [56, 88, 104, 112, 121, 122, 124, 248], [57, 89, 105, 113, 120, 123, 125, 249], [58, 90, 106, 114, 120, 123, 126, 250], [59, 91, 107, 115, 121, 122, 127, 251], [60, 92, 108, 116, 120, 125, 126, 252], [61, 93, 109, 117, 121, 124, 127, 253], [62, 94, 110, 118, 122, 124, 127, 254], [63, 95, 111, 119, 123, 125, 126, 255], [0, 129, 130, 132, 136, 144, 160, 192], [1, 128, 131, 133, 137, 145, 161, 193], [2, 128, 131, 134, 138, 146, 162, 194], [3, 129, 130, 135, 139, 147, 163, 195], [4, 128, 133, 134, 140, 148, 164, 196], [5, 129, 132, 135, 141, 149, 165, 197], [6, 130, 132, 135, 142, 150, 166, 198], [7, 131, 133, 134, 143, 151, 167, 199], [8, 128, 137, 138, 140, 152, 168, 200], [9, 129, 136, 139, 141, 153, 169, 201], [10, 130, 136, 139, 142, 154, 170, 202], [11, 131, 137, 138, 143, 155, 171, 203], [12, 132, 136, 141, 142, 156, 172, 204], [13, 133, 137, 140, 143, 157, 173, 205], [14, 134, 138, 140, 143, 158, 174, 206], [15, 135, 139, 141, 142, 159, 175, 207], [16, 128, 145, 146, 148, 152, 176, 208], [17, 129, 144, 147, 149, 153, 177, 209], [18, 130, 144, 147, 150, 154, 178, 210], [19, 131, 145, 146, 151, 155, 179, 211], [20, 132, 144, 149, 150, 156, 180, 212], [21, 133, 145, 148, 151, 157, 181, 213], [22, 134, 146, 148, 151, 158, 182, 214], [23, 135, 147, 149, 150, 159, 183, 215], [24, 136, 144, 153, 154, 156, 184, 216], [25, 137, 145, 152, 155, 157, 185, 217], [26, 138, 146, 152, 155, 158, 186, 218], [27, 139, 147, 153, 154, 159, 187, 219], [28, 140, 148, 152, 157, 158, 188, 220], [29, 141, 149, 153, 156, 159, 189, 221], [30, 142, 150, 154, 156, 159, 190, 222], [31, 143, 151, 155, 157, 158, 191, 223], [32, 128, 161, 162, 164, 168, 176, 224], [33, 129, 160, 163, 165, 169, 177, 225], [34, 130, 160, 163, 166, 170, 178, 226], [35, 131, 161, 162, 167, 171, 179, 227], [36, 132, 160, 165, 166, 172, 180, 228], [37, 133, 161, 164, 167, 173, 181, 229], [38, 134, 162, 164, 167, 174, 182, 230], [39, 135, 163, 165, 166, 175, 183, 231], [40, 136, 160, 169, 170, 172, 184, 232], [41, 137, 161, 168, 171, 173, 185, 233], [42, 138, 162, 168, 171, 174, 186, 234], [43, 139, 163, 169, 170, 175, 187, 235], [44, 140, 164, 168, 173, 174, 188, 236], [45, 141, 165, 169, 172, 175, 189, 237], [46, 142, 166, 170, 172, 175, 190, 238], [47, 143, 167, 171, 173, 174, 191, 239], [48, 144, 160, 177, 178, 180, 184, 240], [49, 145, 161, 176, 179, 181, 185, 241], [50, 146, 162, 176, 179, 182, 186, 242], [51, 147, 163, 177, 178, 183, 187, 243], [52, 148, 164, 176, 181, 182, 188, 244], [53, 149, 165, 177, 180, 183, 189, 245], [54, 150, 166, 178, 180, 183, 190, 246], [55, 151, 167, 179, 181, 182, 191, 247], [56, 152, 168, 176, 185, 186, 188, 248], [57, 153, 169, 177, 184, 187, 189, 249], [58, 154, 170, 178, 184, 187, 190, 250], [59, 155, 171, 179, 185, 186, 191, 251], [60, 156, 172, 180, 184, 189, 190, 252], [61, 157, 173, 181, 185, 188, 191, 253], [62, 158, 174, 182, 186, 188, 191, 254], [63, 159, 175, 183, 187, 189, 190, 255], [64, 128, 193, 194, 196, 200, 208, 224], [65, 129, 192, 195, 197, 201, 209, 225], [66, 130, 192, 195, 198, 202, 210, 226], [67, 131, 193, 194, 199, 203, 211, 227], [68, 132, 192, 197, 198, 204, 212, 228], [69, 133, 193, 196, 199, 205, 213, 229], [70, 134, 194, 196, 199, 206, 214, 230], [71, 135, 195, 197, 198, 207, 215, 231], [72, 136, 192, 201, 202, 204, 216, 232], [73, 137, 193, 200, 203, 205, 217, 233], [74, 138, 194, 200, 203, 206, 218, 234], [75, 139, 195, 201, 202, 207, 219, 235], [76, 140, 196, 200, 205, 206, 220, 236], [77, 141, 197, 201, 204, 207, 221, 237], [78, 142, 198, 202, 204, 207, 222, 238], [79, 143, 199, 203, 205, 206, 223, 239], [80, 144, 192, 209, 210, 212, 216, 240], [81, 145, 193, 208, 211, 213, 217, 241], [82, 146, 194, 208, 211, 214, 218, 242], [83, 147, 195, 209, 210, 215, 219, 243], [84, 148, 196, 208, 213, 214, 220, 244], [85, 149, 197, 209, 212, 215, 221, 245], [86, 150, 198, 210, 212, 215, 222, 246], [87, 151, 199, 211, 213, 214, 223, 247], [88, 152, 200, 208, 217, 218, 220, 248], [89, 153, 201, 209, 216, 219, 221, 249], [90, 154, 202, 210, 216, 219, 222, 250], [91, 155, 203, 211, 217, 218, 223, 251], [92, 156, 204, 212, 216, 221, 222, 252], [93, 157, 205, 213, 217, 220, 223, 253], [94, 158, 206, 214, 218, 220, 223, 254], [95, 159, 207, 215, 219, 221, 222, 255], [96, 160, 192, 225, 226, 228, 232, 240], [97, 161, 193, 224, 227, 229, 233, 241], [98, 162, 194, 224, 227, 230, 234, 242], [99, 163, 195, 225, 226, 231, 235, 243], [100, 164, 196, 224, 229, 230, 236, 244], [101, 165, 197, 225, 228, 231, 237, 245], [102, 166, 198, 226, 228, 231, 238, 246], [103, 167, 199, 227, 229, 230, 239, 247], [104, 168, 200, 224, 233, 234, 236, 248], [105, 169, 201, 225, 232, 235, 237, 249], [106, 170, 202, 226, 232, 235, 238, 250], [107, 171, 203, 227, 233, 234, 239, 251], [108, 172, 204, 228, 232, 237, 238, 252], [109, 173, 205, 229, 233, 236, 239, 253], [110, 174, 206, 230, 234, 236, 239, 254], [111, 175, 207, 231, 235, 237, 238, 255], [112, 176, 208, 224, 241, 242, 244, 248], [113, 177, 209, 225, 240, 243, 245, 249], [114, 178, 210, 226, 240, 243, 246, 250], [115, 179, 211, 227, 241, 242, 247, 251], [116, 180, 212, 228, 240, 245, 246, 252], [117, 181, 213, 229, 241, 244, 247, 253], [118, 182, 214, 230, 242, 244, 247, 254], [119, 183, 215, 231, 243, 245, 246, 255], [120, 184, 216, 232, 240, 249, 250, 252], [121, 185, 217, 233, 241, 248, 251, 253], [122, 186, 218, 234, 242, 248, 251, 254], [123, 187, 219, 235, 243, 249, 250, 255], [124, 188, 220, 236, 244, 248, 253, 254], [125, 189, 221, 237, 245, 249, 252, 255], [126, 190, 222, 238, 246, 250, 252, 255], [127, 191, 223, 239, 247, 251, 253, 254]], [[1, 2, 4, 8, 16, 32, 64, 128, 256], [0, 3, 5, 9, 17, 33, 65, 129, 257], [0, 3, 6, 10, 18, 34, 66, 130, 258], [1, 2, 7, 11, 19, 35, 67, 131, 259], [0, 5, 6, 12, 20, 36, 68, 132, 260], [1, 4, 7, 13, 21, 37, 69, 133, 261], [2, 4, 7, 14, 22, 38, 70, 134, 262], [3, 5, 6, 15, 23, 39, 71, 135, 263], [0, 9, 10, 12, 24, 40, 72, 136, 264], [1, 8, 11, 13, 25, 41, 73, 137, 265], [2, 8, 11, 14, 26, 42, 74, 138, 266], [3, 9, 10, 15, 27, 43, 75, 139, 267], [4, 8, 13, 14, 28, 44, 76, 140, 268], [5, 9, 12, 15, 29, 45, 77, 141, 269], [6, 10, 12, 15, 30, 46, 78, 142, 270], [7, 11, 13, 14, 31, 47, 79, 143, 271], [0, 17, 18, 20, 24, 48, 80, 144, 272], [1, 16, 19, 21, 25, 49, 81, 145, 273], [2, 16, 19, 22, 26, 50, 82, 146, 274], [3, 17, 18, 23, 27, 51, 83, 147, 275], [4, 16, 21, 22, 28, 52, 84, 148, 276], [5, 17, 20, 23, 29, 53, 85, 149, 277], [6, 18, 20, 23, 30, 54, 86, 150, 278], [7, 19, 21, 22, 31, 55, 87, 151, 279], [8, 16, 25, 26, 28, 56, 88, 152, 280], [9, 17, 24, 27, 29, 57, 89, 153, 281], [10, 18, 24, 27, 30, 58, 90, 154, 282], [11, 19, 25, 26, 31, 59, 91, 155, 283], [12, 20, 24, 29, 30, 60, 92, 156, 284], [13, 21, 25, 28, 31, 61, 93, 157, 285], [14, 22, 26, 28, 31, 62, 94, 158, 286], [15, 23, 27, 29, 30, 63, 95, 159, 287], [0, 33, 34, 36, 40, 48, 96, 160, 288], [1, 32, 35, 37, 41, 49, 97, 161, 289], [2, 32, 35, 38, 42, 50, 98, 162, 290], [3, 33, 34, 39, 43, 51, 99, 163, 291], [4, 32, 37, 38, 44, 52, 100, 164, 292], [5, 33, 36, 39, 45, 53, 101, 165, 293], [6, 34, 36, 39, 46, 54, 102, 166, 294], [7, 35, 37, 38, 47, 55, 103, 167, 295], [8, 32, 41, 42, 44, 56, 104, 168, 296], [9, 33, 40, 43, 45, 57, 105, 169, 297], [10, 34, 40, 43, 46, 58, 106, 170, 298], [11, 35, 41, 42, 47, 59, 107, 171, 299], [12, 36, 40, 45, 46, 60, 108, 172, 300], [13, 37, 41, 44, 47, 61, 109, 173, 301], [14, 38, 42, 44, 47, 62, 110, 174, 302], [15, 39, 43, 45, 46, 63, 111, 175, 303], [16, 32, 49, 50, 52, 56, 112, 176, 304], [17, 33, 48, 51, 53, 57, 113, 177, 305], [18, 34, 48, 51, 54, 58, 114, 178, 306], [19, 35, 49, 50, 55, 59, 115, 179, 307], [20, 36, 48, 53, 54, 60, 116, 180, 308], [21, 37, 49, 52, 55, 61, 117, 181, 309], [22, 38, 50, 52, 55, 62, 118, 182, 310], [23, 39, 51, 53, 54, 63, 119, 183, 311], [24, 40, 48, 57, 58, 60, 120, 184, 312], [25, 41, 49, 56, 59, 61, 121, 185, 313], [26, 42, 50, 56, 59, 62, 122, 186, 314], [27, 43, 51, 57, 58, 63, 123, 187, 315], [28, 44, 52, 56, 61, 62, 124, 188, 316], [29, 45, 53, 57, 60, 63, 125, 189, 317], [30, 46, 54, 58, 60, 63, 126, 190, 318], [31, 47, 55, 59, 61, 62, 127, 191, 319], [0, 65, 66, 68, 72, 80, 96, 192, 320], [1, 64, 67, 69, 73, 81, 97, 193, 321], [2, 64, 67, 70, 74, 82, 98, 194, 322], [3, 65, 66, 71, 75, 83, 99, 195, 323], [4, 64, 69, 70, 76, 84, 100, 196, 324], [5, 65, 68, 71, 77, 85, 101, 197, 325], [6, 66, 68, 71, 78, 86, 102, 198, 326], [7, 67, 69, 70, 79, 87, 103, 199, 327], [8, 64, 73, 74, 76, 88, 104, 200, 328], [9, 65, 72, 75, 77, 89, 105, 201, 329], [10, 66, 72, 75, 78, 90, 106, 202, 330], [11, 67, 73, 74, 79, 91, 107, 203, 331], [12, 68, 72, 77, 78, 92, 108, 204, 332], [13, 69, 73, 76, 79, 93, 109, 205, 333], [14, 70, 74, 76, 79, 94, 110, 206, 334], [15, 71, 75, 77, 78, 95, 111, 207, 335], [16, 64, 81, 82, 84, 88, 112, 208, 336], [17, 65, 80, 83, 85, 89, 113, 209, 337], [18, 66, 80, 83, 86, 90, 114, 210, 338], [19, 67, 81, 82, 87, 91, 115, 211, 339], [20, 68, 80, 85, 86, 92, 116, 212, 340], [21, 69, 81, 84, 87, 93, 117, 213, 341], [22, 70, 82, 84, 87, 94, 118, 214, 342], [23, 71, 83, 85, 86, 95, 119, 215, 343], [24, 72, 80, 89, 90, 92, 120, 216, 344], [25, 73, 81, 88, 91, 93, 121, 217, 345], [26, 74, 82, 88, 91, 94, 122, 218, 346], [27, 75, 83, 89, 90, 95, 123, 219, 347], [28, 76, 84, 88, 93, 94, 124, 220, 348], [29, 77, 85, 89, 92, 95, 125, 221, 349], [30, 78, 86, 90, 92, 95, 126, 222, 350], [31, 79, 87, 91, 93, 94, 127, 223, 351], [32, 64, 97, 98, 100, 104, 112, 224, 352], [33, 65, 96, 99, 101, 105, 113, 225, 353], [34, 66, 96, 99, 102, 106, 114, 226, 354], [35, 67, 97, 98, 103, 107, 115, 227, 355], [36, 68, 96, 101, 102, 108, 116, 228, 356], [37, 69, 97, 100, 103, 109, 117, 229, 357], [38, 70, 98, 100, 103, 110, 118, 230, 358], [39, 71, 99, 101, 102, 111, 119, 231, 359], [40, 72, 96, 105, 106, 108, 120, 232, 360], [41, 73, 97, 104, 107, 109, 121, 233, 361], [42, 74, 98, 104, 107, 110, 122, 234, 362], [43, 75, 99, 105, 106, 111, 123, 235, 363], [44, 76, 100, 104, 109, 110, 124, 236, 364], [45, 77, 101, 105, 108, 111, 125, 237, 365], [46, 78, 102, 106, 108, 111, 126, 238, 366], [47, 79, 103, 107, 109, 110, 127, 239, 367], [48, 80, 96, 113, 114, 116, 120, 240, 368], [49, 81, 97, 112, 115, 117, 121, 241, 369], [50, 82, 98, 112, 115, 118, 122, 242, 370], [51, 83, 99, 113, 114, 119, 123, 243, 371], [52, 84, 100, 112, 117, 118, 124, 244, 372], [53, 85, 101, 113, 116, 119, 125, 245, 373], [54, 86, 102, 114, 116, 119, 126, 246, 374], [55, 87, 103, 115, 117, 118, 127, 247, 375], [56, 88, 104, 112, 121, 122, 124, 248, 376], [57, 89, 105, 113, 120, 123, 125, 249, 377], [58, 90, 106, 114, 120, 123, 126, 250, 378], [59, 91, 107, 115, 121, 122, 127, 251, 379], [60, 92, 108, 116, 120, 125, 126, 252, 380], [61, 93, 109, 117, 121, 124, 127, 253, 381], [62, 94, 110, 118, 122, 124, 127, 254, 382], [63, 95, 111, 119, 123, 125, 126, 255, 383], [0, 129, 130, 132, 136, 144, 160, 192, 384], [1, 128, 131, 133, 137, 145, 161, 193, 385], [2, 128, 131, 134, 138, 146, 162, 194, 386], [3, 129, 130, 135, 139, 147, 163, 195, 387], [4, 128, 133, 134, 140, 148, 164, 196, 388], [5, 129, 132, 135, 141, 149, 165, 197, 389], [6, 130, 132, 135, 142, 150, 166, 198, 390], [7, 131, 133, 134, 143, 151, 167, 199, 391], [8, 128, 137, 138, 140, 152, 168, 200, 392], [9, 129, 136, 139, 141, 153, 169, 201, 393], [10, 130, 136, 139, 142, 154, 170, 202, 394], [11, 131, 137, 138, 143, 155, 171, 203, 395], [12, 132, 136, 141, 142, 156, 172, 204, 396], [13, 133, 137, 140, 143, 157, 173, 205, 397], [14, 134, 138, 140, 143, 158, 174, 206, 398], [15, 135, 139, 141, 142, 159, 175, 207, 399], [16, 128, 145, 146, 148, 152, 176, 208, 400], [17, 129, 144, 147, 149, 153, 177, 209, 401], [18, 130, 144, 147, 150, 154, 178, 210, 402], [19, 131, 145, 146, 151, 155, 179, 211, 403], [20, 132, 144, 149, 150, 156, 180, 212, 404], [21, 133, 145, 148, 151, 157, 181, 213, 405], [22, 134, 146, 148, 151, 158, 182, 214, 406], [23, 135, 147, 149, 150, 159, 183, 215, 407], [24, 136, 144, 153, 154, 156, 184, 216, 408], [25, 137, 145, 152, 155, 157, 185, 217, 409], [26, 138, 146, 152, 155, 158, 186, 218, 410], [27, 139, 147, 153, 154, 159, 187, 219, 411], [28, 140, 148, 152, 157, 158, 188, 220, 412], [29, 141, 149, 153, 156, 159, 189, 221, 413], [30, 142, 150, 154, 156, 159, 190, 222, 414], [31, 143, 151, 155, 157, 158, 191, 223, 415], [32, 128, 161, 162, 164, 168, 176, 224, 416], [33, 129, 160, 163, 165, 169, 177, 225, 417], [34, 130, 160, 163, 166, 170, 178, 226, 418], [35, 131, 161, 162, 167, 171, 179, 227, 419], [36, 132, 160, 165, 166, 172, 180, 228, 420], [37, 133, 161, 164, 167, 173, 181, 229, 421], [38, 134, 162, 164, 167, 174, 182, 230, 422], [39, 135, 163, 165, 166, 175, 183, 231, 423], [40, 136, 160, 169, 170, 172, 184, 232, 424], [41, 137, 161, 168, 171, 173, 185, 233, 425], [42, 138, 162, 168, 171, 174, 186, 234, 426], [43, 139, 163, 169, 170, 175, 187, 235, 427], [44, 140, 164, 168, 173, 174, 188, 236, 428], [45, 141, 165, 169, 172, 175, 189, 237, 429], [46, 142, 166, 170, 172, 175, 190, 238, 430], [47, 143, 167, 171, 173, 174, 191, 239, 431], [48, 144, 160, 177, 178, 180, 184, 240, 432], [49, 145, 161, 176, 179, 181, 185, 241, 433], [50, 146, 162, 176, 179, 182, 186, 242, 434], [51, 147, 163, 177, 178, 183, 187, 243, 435], [52, 148, 164, 176, 181, 182, 188, 244, 436], [53, 149, 165, 177, 180, 183, 189, 245, 437], [54, 150, 166, 178, 180, 183, 190, 246, 438], [55, 151, 167, 179, 181, 182, 191, 247, 439], [56, 152, 168, 176, 185, 186, 188, 248, 440], [57, 153, 169, 177, 184, 187, 189, 249, 441], [58, 154, 170, 178, 184, 187, 190, 250, 442], [59, 155, 171, 179, 185, 186, 191, 251, 443], [60, 156, 172, 180, 184, 189, 190, 252, 444], [61, 157, 173, 181, 185, 188, 191, 253, 445], [62, 158, 174, 182, 186, 188, 191, 254, 446], [63, 159, 175, 183, 187, 189, 190, 255, 447], [64, 128, 193, 194, 196, 200, 208, 224, 448], [65, 129, 192, 195, 197, 201, 209, 225, 449], [66, 130, 192, 195, 198, 202, 210, 226, 450], [67, 131, 193, 194, 199, 203, 211, 227, 451], [68, 132, 192, 197, 198, 204, 212, 228, 452], [69, 133, 193, 196, 199, 205, 213, 229, 453], [70, 134, 194, 196, 199, 206, 214, 230, 454], [71, 135, 195, 197, 198, 207, 215, 231, 455], [72, 136, 192, 201, 202, 204, 216, 232, 456], [73, 137, 193, 200, 203, 205, 217, 233, 457], [74, 138, 194, 200, 203, 206, 218, 234, 458], [75, 139, 195, 201, 202, 207, 219, 235, 459], [76, 140, 196, 200, 205, 206, 220, 236, 460], [77, 141, 197, 201, 204, 207, 221, 237, 461], [78, 142, 198, 202, 204, 207, 222, 238, 462], [79, 143, 199, 203, 205, 206, 223, 239, 463], [80, 144, 192, 209, 210, 212, 216, 240, 464], [81, 145, 193, 208, 211, 213, 217, 241, 465], [82, 146, 194, 208, 211, 214, 218, 242, 466], [83, 147, 195, 209, 210, 215, 219, 243, 467], [84, 148, 196, 208, 213, 214, 220, 244, 468], [85, 149, 197, 209, 212, 215, 221, 245, 469], [86, 150, 198, 210, 212, 215, 222, 246, 470], [87, 151, 199, 211, 213, 214, 223, 247, 471], [88, 152, 200, 208, 217, 218, 220, 248, 472], [89, 153, 201, 209, 216, 219, 221, 249, 473], [90, 154, 202, 210, 216, 219, 222, 250, 474], [91, 155, 203, 211, 217, 218, 223, 251, 475], [92, 156, 204, 212, 216, 221, 222, 252, 476], [93, 157, 205, 213, 217, 220, 223, 253, 477], [94, 158, 206, 214, 218, 220, 223, 254, 478], [95, 159, 207, 215, 219, 221, 222, 255, 479], [96, 160, 192, 225, 226, 228, 232, 240, 480], [97, 161, 193, 224, 227, 229, 233, 241, 481], [98, 162, 194, 224, 227, 230, 234, 242, 482], [99, 163, 195, 225, 226, 231, 235, 243, 483], [100, 164, 196, 224, 229, 230, 236, 244, 484], [101, 165, 197, 225, 228, 231, 237, 245, 485], [102, 166, 198, 226, 228, 231, 238, 246, 486], [103, 167, 199, 227, 229, 230, 239, 247, 487], [104, 168, 200, 224, 233, 234, 236, 248, 488], [105, 169, 201, 225, 232, 235, 237, 249, 489], [106, 170, 202, 226, 232, 235, 238, 250, 490], [107, 171, 203, 227, 233, 234, 239, 251, 491], [108, 172, 204, 228, 232, 237, 238, 252, 492], [109, 173, 205, 229, 233, 236, 239, 253, 493], [110, 174, 206, 230, 234, 236, 239, 254, 494], [111, 175, 207, 231, 235, 237, 238, 255, 495], [112, 176, 208, 224, 241, 242, 244, 248, 496], [113, 177, 209, 225, 240, 243, 245, 249, 497], [114, 178, 210, 226, 240, 243, 246, 250, 498], [115, 179, 211, 227, 241, 242, 247, 251, 499], [116, 180, 212, 228, 240, 245, 246, 252, 500], [117, 181, 213, 229, 241, 244, 247, 253, 501], [118, 182, 214, 230, 242, 244, 247, 254, 502], [119, 183, 215, 231, 243, 245, 246, 255, 503], [120, 184, 216, 232, 240, 249, 250, 252, 504], [121, 185, 217, 233, 241, 248, 251, 253, 505], [122, 186, 218, 234, 242, 248, 251, 254, 506], [123, 187, 219, 235, 243, 249, 250, 255, 507], [124, 188, 220, 236, 244, 248, 253, 254, 508], [125, 189, 221, 237, 245, 249, 252, 255, 509], [126, 190, 222, 238, 246, 250, 252, 255, 510], [127, 191, 223, 239, 247, 251, 253, 254, 511], [0, 257, 258, 260, 264, 272, 288, 320, 384], [1, 256, 259, 261, 265, 273, 289, 321, 385], [2, 256, 259, 262, 266, 274, 290, 322, 386], [3, 257, 258, 263, 267, 275, 291, 323, 387], [4, 256, 261, 262, 268, 276, 292, 324, 388], [5, 257, 260, 263, 269, 277, 293, 325, 389], [6, 258, 260, 263, 270, 278, 294, 326, 390], [7, 259, 261, 262, 271, 279, 295, 327, 391], [8, 256, 265, 266, 268, 280, 296, 328, 392], [9, 257, 264, 267, 269, 281, 297, 329, 393], [10, 258, 264, 267, 270, 282, 298, 330, 394], [11, 259, 265, 266, 271, 283, 299, 331, 395], [12, 260, 264, 269, 270, 284, 300, 332, 396], [13, 261, 265, 268, 271, 285, 301, 333, 397], [14, 262, 266, 268, 271, 286, 302, 334, 398], [15, 263, 267, 269, 270, 287, 303, 335, 399], [16, 256, 273, 274, 276, 280, 304, 336, 400], [17, 257, 272, 275, 277, 281, 305, 337, 401], [18, 258, 272, 275, 278, 282, 306, 338, 402], [19, 259, 273, 274, 279, 283, 307, 339, 403], [20, 260, 272, 277, 278, 284, 308, 340, 404], [21, 261, 273, 276, 279, 285, 309, 341, 405], [22, 262, 274, 276, 279, 286, 310, 342, 406], [23, 263, 275, 277, 278, 287, 311, 343, 407], [24, 264, 272, 281, 282, 284, 312, 344, 408], [25, 265, 273, 280, 283, 285, 313, 345, 409], [26, 266, 274, 280, 283, 286, 314, 346, 410], [27, 267, 275, 281, 282, 287, 315, 347, 411], [28, 268, 276, 280, 285, 286, 316, 348, 412], [29, 269, 277, 281, 284, 287, 317, 349, 413], [30, 270, 278, 282, 284, 287, 318, 350, 414], [31, 271, 279, 283, 285, 286, 319, 351, 415], [32, 256, 289, 290, 292, 296, 304, 352, 416], [33, 257, 288, 291, 293, 297, 305, 353, 417], [34, 258, 288, 291, 294, 298, 306, 354, 418], [35, 259, 289, 290, 295, 299, 307, 355, 419], [36, 260, 288, 293, 294, 300, 308, 356, 420], [37, 261, 289, 292, 295, 301, 309, 357, 421], [38, 262, 290, 292, 295, 302, 310, 358, 422], [39, 263, 291, 293, 294, 303, 311, 359, 423], [40, 264, 288, 297, 298, 300, 312, 360, 424], [41, 265, 289, 296, 299, 301, 313, 361, 425], [42, 266, 290, 296, 299, 302, 314, 362, 426], [43, 267, 291, 297, 298, 303, 315, 363, 427], [44, 268, 292, 296, 301, 302, 316, 364, 428], [45, 269, 293, 297, 300, 303, 317, 365, 429], [46, 270, 294, 298, 300, 303, 318, 366, 430], [47, 271, 295, 299, 301, 302, 319, 367, 431], [48, 272, 288, 305, 306, 308, 312, 368, 432], [49, 273, 289, 304, 307, 309, 313, 369, 433], [50, 274, 290, 304, 307, 310, 314, 370, 434], [51, 275, 291, 305, 306, 311, 315, 371, 435], [52, 276, 292, 304, 309, 310, 316, 372, 436], [53, 277, 293, 305, 308, 311, 317, 373, 437], [54, 278, 294, 306, 308, 311, 318, 374, 438], [55, 279, 295, 307, 309, 310, 319, 375, 439], [56, 280, 296, 304, 313, 314, 316, 376, 440], [57, 281, 297, 305, 312, 315, 317, 377, 441], [58, 282, 298, 306, 312, 315, 318, 378, 442], [59, 283, 299, 307, 313, 314, 319, 379, 443], [60, 284, 300, 308, 312, 317, 318, 380, 444], [61, 285, 301, 309, 313, 316, 319, 381, 445], [62, 286, 302, 310, 314, 316, 319, 382, 446], [63, 287, 303, 311, 315, 317, 318, 383, 447], [64, 256, 321, 322, 324, 328, 336, 352, 448], [65, 257, 320, 323, 325, 329, 337, 353, 449], [66, 258, 320, 323, 326, 330, 338, 354, 450], [67, 259, 321, 322, 327, 331, 339, 355, 451], [68, 260, 320, 325, 326, 332, 340, 356, 452], [69, 261, 321, 324, 327, 333, 341, 357, 453], [70, 262, 322, 324, 327, 334, 342, 358, 454], [71, 263, 323, 325, 326, 335, 343, 359, 455], [72, 264, 320, 329, 330, 332, 344, 360, 456], [73, 265, 321, 328, 331, 333, 345, 361, 457], [74, 266, 322, 328, 331, 334, 346, 362, 458], [75, 267, 323, 329, 330, 335, 347, 363, 459], [76, 268, 324, 328, 333, 334, 348, 364, 460], [77, 269, 325, 329, 332, 335, 349, 365, 461], [78, 270, 326, 330, 332, 335, 350, 366, 462], [79, 271, 327, 331, 333, 334, 351, 367, 463], [80, 272, 320, 337, 338, 340, 344, 368, 464], [81, 273, 321, 336, 339, 341, 345, 369, 465], [82, 274, 322, 336, 339, 342, 346, 370, 466], [83, 275, 323, 337, 338, 343, 347, 371, 467], [84, 276, 324, 336, 341, 342, 348, 372, 468], [85, 277, 325, 337, 340, 343, 349, 373, 469], [86, 278, 326, 338, 340, 343, 350, 374, 470], [87, 279, 327, 339, 341, 342, 351, 375, 471], [88, 280, 328, 336, 345, 346, 348, 376, 472], [89, 281, 329, 337, 344, 347, 349, 377, 473], [90, 282, 330, 338, 344, 347, 350, 378, 474], [91, 283, 331, 339, 345, 346, 351, 379, 475], [92, 284, 332, 340, 344, 349, 350, 380, 476], [93, 285, 333, 341, 345, 348, 351, 381, 477], [94, 286, 334, 342, 346, 348, 351, 382, 478], [95, 287, 335, 343, 347, 349, 350, 383, 479], [96, 288, 320, 353, 354, 356, 360, 368, 480], [97, 289, 321, 352, 355, 357, 361, 369, 481], [98, 290, 322, 352, 355, 358, 362, 370, 482], [99, 291, 323, 353, 354, 359, 363, 371, 483], [100, 292, 324, 352, 357, 358, 364, 372, 484], [101, 293, 325, 353, 356, 359, 365, 373, 485], [102, 294, 326, 354, 356, 359, 366, 374, 486], [103, 295, 327, 355, 357, 358, 367, 375, 487], [104, 296, 328, 352, 361, 362, 364, 376, 488], [105, 297, 329, 353, 360, 363, 365, 377, 489], [106, 298, 330, 354, 360, 363, 366, 378, 490], [107, 299, 331, 355, 361, 362, 367, 379, 491], [108, 300, 332, 356, 360, 365, 366, 380, 492], [109, 301, 333, 357, 361, 364, 367, 381, 493], [110, 302, 334, 358, 362, 364, 367, 382, 494], [111, 303, 335, 359, 363, 365, 366, 383, 495], [112, 304, 336, 352, 369, 370, 372, 376, 496], [113, 305, 337, 353, 368, 371, 373, 377, 497], [114, 306, 338, 354, 368, 371, 374, 378, 498], [115, 307, 339, 355, 369, 370, 375, 379, 499], [116, 308, 340, 356, 368, 373, 374, 380, 500], [117, 309, 341, 357, 369, 372, 375, 381, 501], [118, 310, 342, 358, 370, 372, 375, 382, 502], [119, 311, 343, 359, 371, 373, 374, 383, 503], [120, 312, 344, 360, 368, 377, 378, 380, 504], [121, 313, 345, 361, 369, 376, 379, 381, 505], [122, 314, 346, 362, 370, 376, 379, 382, 506], [123, 315, 347, 363, 371, 377, 378, 383, 507], [124, 316, 348, 364, 372, 376, 381, 382, 508], [125, 317, 349, 365, 373, 377, 380, 383, 509], [126, 318, 350, 366, 374, 378, 380, 383, 510], [127, 319, 351, 367, 375, 379, 381, 382, 511], [128, 256, 385, 386, 388, 392, 400, 416, 448], [129, 257, 384, 387, 389, 393, 401, 417, 449], [130, 258, 384, 387, 390, 394, 402, 418, 450], [131, 259, 385, 386, 391, 395, 403, 419, 451], [132, 260, 384, 389, 390, 396, 404, 420, 452], [133, 261, 385, 388, 391, 397, 405, 421, 453], [134, 262, 386, 388, 391, 398, 406, 422, 454], [135, 263, 387, 389, 390, 399, 407, 423, 455], [136, 264, 384, 393, 394, 396, 408, 424, 456], [137, 265, 385, 392, 395, 397, 409, 425, 457], [138, 266, 386, 392, 395, 398, 410, 426, 458], [139, 267, 387, 393, 394, 399, 411, 427, 459], [140, 268, 388, 392, 397, 398, 412, 428, 460], [141, 269, 389, 393, 396, 399, 413, 429, 461], [142, 270, 390, 394, 396, 399, 414, 430, 462], [143, 271, 391, 395, 397, 398, 415, 431, 463], [144, 272, 384, 401, 402, 404, 408, 432, 464], [145, 273, 385, 400, 403, 405, 409, 433, 465], [146, 274, 386, 400, 403, 406, 410, 434, 466], [147, 275, 387, 401, 402, 407, 411, 435, 467], [148, 276, 388, 400, 405, 406, 412, 436, 468], [149, 277, 389, 401, 404, 407, 413, 437, 469], [150, 278, 390, 402, 404, 407, 414, 438, 470], [151, 279, 391, 403, 405, 406, 415, 439, 471], [152, 280, 392, 400, 409, 410, 412, 440, 472], [153, 281, 393, 401, 408, 411, 413, 441, 473], [154, 282, 394, 402, 408, 411, 414, 442, 474], [155, 283, 395, 403, 409, 410, 415, 443, 475], [156, 284, 396, 404, 408, 413, 414, 444, 476], [157, 285, 397, 405, 409, 412, 415, 445, 477], [158, 286, 398, 406, 410, 412, 415, 446, 478], [159, 287, 399, 407, 411, 413, 414, 447, 479], [160, 288, 384, 417, 418, 420, 424, 432, 480], [161, 289, 385, 416, 419, 421, 425, 433, 481], [162, 290, 386, 416, 419, 422, 426, 434, 482], [163, 291, 387, 417, 418, 423, 427, 435, 483], [164, 292, 388, 416, 421, 422, 428, 436, 484], [165, 293, 389, 417, 420, 423, 429, 437, 485], [166, 294, 390, 418, 420, 423, 430, 438, 486], [167, 295, 391, 419, 421, 422, 431, 439, 487], [168, 296, 392, 416, 425, 426, 428, 440, 488], [169, 297, 393, 417, 424, 427, 429, 441, 489], [170, 298, 394, 418, 424, 427, 430, 442, 490], [171, 299, 395, 419, 425, 426, 431, 443, 491], [172, 300, 396, 420, 424, 429, 430, 444, 492], [173, 301, 397, 421, 425, 428, 431, 445, 493], [174, 302, 398, 422, 426, 428, 431, 446, 494], [175, 303, 399, 423, 427, 429, 430, 447, 495], [176, 304, 400, 416, 433, 434, 436, 440, 496], [177, 305, 401, 417, 432, 435, 437, 441, 497], [178, 306, 402, 418, 432, 435, 438, 442, 498], [179, 307, 403, 419, 433, 434, 439, 443, 499], [180, 308, 404, 420, 432, 437, 438, 444, 500], [181, 309, 405, 421, 433, 436, 439, 445, 501], [182, 310, 406, 422, 434, 436, 439, 446, 502], [183, 311, 407, 423, 435, 437, 438, 447, 503], [184, 312, 408, 424, 432, 441, 442, 444, 504], [185, 313, 409, 425, 433, 440, 443, 445, 505], [186, 314, 410, 426, 434, 440, 443, 446, 506], [187, 315, 411, 427, 435, 441, 442, 447, 507], [188, 316, 412, 428, 436, 440, 445, 446, 508], [189, 317, 413, 429, 437, 441, 444, 447, 509], [190, 318, 414, 430, 438, 442, 444, 447, 510], [191, 319, 415, 431, 439, 443, 445, 446, 511], [192, 320, 384, 449, 450, 452, 456, 464, 480], [193, 321, 385, 448, 451, 453, 457, 465, 481], [194, 322, 386, 448, 451, 454, 458, 466, 482], [195, 323, 387, 449, 450, 455, 459, 467, 483], [196, 324, 388, 448, 453, 454, 460, 468, 484], [197, 325, 389, 449, 452, 455, 461, 469, 485], [198, 326, 390, 450, 452, 455, 462, 470, 486], [199, 327, 391, 451, 453, 454, 463, 471, 487], [200, 328, 392, 448, 457, 458, 460, 472, 488], [201, 329, 393, 449, 456, 459, 461, 473, 489], [202, 330, 394, 450, 456, 459, 462, 474, 490], [203, 331, 395, 451, 457, 458, 463, 475, 491], [204, 332, 396, 452, 456, 461, 462, 476, 492], [205, 333, 397, 453, 457, 460, 463, 477, 493], [206, 334, 398, 454, 458, 460, 463, 478, 494], [207, 335, 399, 455, 459, 461, 462, 479, 495], [208, 336, 400, 448, 465, 466, 468, 472, 496], [209, 337, 401, 449, 464, 467, 469, 473, 497], [210, 338, 402, 450, 464, 467, 470, 474, 498], [211, 339, 403, 451, 465, 466, 471, 475, 499], [212, 340, 404, 452, 464, 469, 470, 476, 500], [213, 341, 405, 453, 465, 468, 471, 477, 501], [214, 342, 406, 454, 466, 468, 471, 478, 502], [215, 343, 407, 455, 467, 469, 470, 479, 503], [216, 344, 408, 456, 464, 473, 474, 476, 504], [217, 345, 409, 457, 465, 472, 475, 477, 505], [218, 346, 410, 458, 466, 472, 475, 478, 506], [219, 347, 411, 459, 467, 473, 474, 479, 507], [220, 348, 412, 460, 468, 472, 477, 478, 508], [221, 349, 413, 461, 469, 473, 476, 479, 509], [222, 350, 414, 462, 470, 474, 476, 479, 510], [223, 351, 415, 463, 471, 475, 477, 478, 511], [224, 352, 416, 448, 481, 482, 484, 488, 496], [225, 353, 417, 449, 480, 483, 485, 489, 497], [226, 354, 418, 450, 480, 483, 486, 490, 498], [227, 355, 419, 451, 481, 482, 487, 491, 499], [228, 356, 420, 452, 480, 485, 486, 492, 500], [229, 357, 421, 453, 481, 484, 487, 493, 501], [230, 358, 422, 454, 482, 484, 487, 494, 502], [231, 359, 423, 455, 483, 485, 486, 495, 503], [232, 360, 424, 456, 480, 489, 490, 492, 504], [233, 361, 425, 457, 481, 488, 491, 493, 505], [234, 362, 426, 458, 482, 488, 491, 494, 506], [235, 363, 427, 459, 483, 489, 490, 495, 507], [236, 364, 428, 460, 484, 488, 493, 494, 508], [237, 365, 429, 461, 485, 489, 492, 495, 509], [238, 366, 430, 462, 486, 490, 492, 495, 510], [239, 367, 431, 463, 487, 491, 493, 494, 511], [240, 368, 432, 464, 480, 497, 498, 500, 504], [241, 369, 433, 465, 481, 496, 499, 501, 505], [242, 370, 434, 466, 482, 496, 499, 502, 506], [243, 371, 435, 467, 483, 497, 498, 503, 507], [244, 372, 436, 468, 484, 496, 501, 502, 508], [245, 373, 437, 469, 485, 497, 500, 503, 509], [246, 374, 438, 470, 486, 498, 500, 503, 510], [247, 375, 439, 471, 487, 499, 501, 502, 511], [248, 376, 440, 472, 488, 496, 505, 506, 508], [249, 377, 441, 473, 489, 497, 504, 507, 509], [250, 378, 442, 474, 490, 498, 504, 507, 510], [251, 379, 443, 475, 491, 499, 505, 506, 511], [252, 380, 444, 476, 492, 500, 504, 509, 510], [253, 381, 445, 477, 493, 501, 505, 508, 511], [254, 382, 446, 478, 494, 502, 506, 508, 511], [255, 383, 447, 479, 495, 503, 507, 509, 510]]]
#print(len(hiperkocke_9))
#
#k=2
#for i,graf in enumerate(hiperkocke_9):
#    dim = i+1
#    print(f"fi(H_{dim},{k}) = {vse_pk(graf,k)}, fi_i(H_{dim},{k}) = {vse_inducirane_pk(graf,k)}")

def shrani_razpredelnico(razpredelnica):
    slovar_json = razpredelnica.to_json(orient = "columns")
    out_file = open("stanje.json", "w")
    json.dump(slovar_json, out_file)
    out_file.close()
    print("razpredelnica shranjena")

def preberi_razpredelnico(ime_json_datoteke):
    f = open(ime_json_datoteke)
    data1 = json.load(f)
    df = pd.read_json(data1, orient ='columns')
    return df



def preberi_xlsx_fi(ime_dat, sheet=None, inducirane = False, k_min=1, k_max=None, n_min=1, n_max=None, transpose = False): #pazi k_minn n_min je za indexiranje vrstic, k_max pa n_max je do kam gre
    data = pd.read_excel(ime_dat, header=None, sheet_name = sheet)
    if transpose:
        data = data.transpose()
    data = data.iloc[:,:n_max]
    data = data.rename(index = lambda x: x+k_min).rename(columns = lambda x: f"n = {x+n_min}")
    def izlušči(besedilo):
        try:
            vzorec = r"fi\(\w_?\d?,\d+\) = (?P<fi>\d+), fi_i\(\w_?\d?,\d+\) = (?P<fi_i>\d+)"
            match = re.search(vzorec, besedilo)
            fi = match.group(1 + int(inducirane))
            return fi
        except:
            return 0
    return data.applymap(izlušči).astype(int)

def primerjalna_razpred(df_fi, df_fi_i, n):
    x = df_fi.iloc[:,n]
    y = df_fi_i.iloc[:,n]
    nov = pd.concat([x,y], axis = 1)
    nov.columns = [r"$\Phi$", r"$\Phi_i$"]
    return nov
    





#print(pt_fi)
#print(hk_fi_i)

def nariši_graf(df, ylab, naslov, tip_grafa):
    induciran = "IND" in naslov
    plt.rcParams['text.usetex'] = True
    plt.rcParams["legend.loc"] = 'upper left'
    fig, ax = plt.subplots(figsize=(8, 5), tight_layout=True)
    x_os = df.index
    ax.xaxis.set_ticks(x_os)

    if tip_grafa == "pt":
        label = ["dodekaeder", "ikozaeder", "oktaeder"]#[::-1]
    elif tip_grafa == "hk":
        label = [f"n = {n}" for n in range(1,len(df.columns)+1)]
    elif tip_grafa == "clg":
        label = [f"n = {n+2}" for n in range(1,len(df.columns)+1)]
    elif tip_grafa == "sr":
        label = [f"n = {n+1}" for n in range(1,len(df.columns)+1)]
    else:
        print("napaka tip grafa")

    ax.plot(x_os, df, label = label, marker = ".")
    ax.legend()

    ax.set_xlabel(r'\textbf{$k$}', fontsize = 16)
    ax.set_ylabel(ylab, fontsize = 16)
    ax.set_title(naslov, fontsize=16)

    plt.savefig(f'{tip_grafa}{"_i"*int(induciran)}.png')
    #plt.show() 


def nariši_graf_primerjave(df, naslov, ylab):
    plt.rcParams['text.usetex'] = True
    plt.rcParams["legend.loc"] = 'upper left'
    fig, ax = plt.subplots(figsize=(8, 5), tight_layout=True)
    x_os = df.index
    ax.xaxis.set_ticks(x_os)

    ax.plot(x_os, df, marker = ".", label = ["št. kopij", "št. induciranih kopij"])
    ax.legend()

    ax.set_xlabel(r'\textbf{$k$}', fontsize = 16)
    #ax.set_ylabel(ylab, fontsize = 16)
    ax.set_title(naslov, fontsize=16)

    plt.savefig('primerjava.png')
    plt.show() 




#MAIN
hk_fi = preberi_xlsx_fi("fp_rez.xlsx", sheet = "Sheet1",inducirane = False, transpose = True, k_min = 2, n_max = 6)
hk_fi_i = preberi_xlsx_fi("fp_rez.xlsx", sheet = "Sheet1", inducirane = True, transpose = True, k_min = 2, n_max = 6)
pt_fi = preberi_xlsx_fi("fp_rez 2.xlsx", sheet="plat" ,inducirane = False, k_min = 1, n_max = 6)
pt_fi_i = preberi_xlsx_fi("fp_rez 2.xlsx",sheet="plat", inducirane = True, k_min = 1, n_max = 6)
sr_fi = preberi_xlsx_fi("fp_rez 2.xlsx", sheet="serp",inducirane = False, k_min = 1, n_max = 3)
sr_fi_i = preberi_xlsx_fi("fp_rez 2.xlsx", sheet="serp",inducirane = True, k_min = 1, n_max = 3)
clg_fi = preberi_xlsx_fi("fp_rez 2.xlsx", sheet="clg",inducirane = False, k_min = 1, n_min=3)#, n_max=6)
clg_fi_i = preberi_xlsx_fi("fp_rez 2.xlsx", sheet="clg",inducirane = True, k_min = 1, n_min=3)#, n_max=6)


nariši_graf(hk_fi, tip_grafa = "hk",ylab = r'\textbf{$\Phi(G_n,k)$}', naslov = r'\textbf{ŠTEVILO KOPIJ $P_k$ V HIPERKOCKAH}')
nariši_graf(hk_fi_i, tip_grafa = "hk",ylab = r'\textbf{$\Phi_i(G_n,k)$}', naslov = r'\textbf{ŠTEVILO INDUCIRANIH KOPIJ $P_k$ V HIPERKOCKAH}')
nariši_graf(pt_fi, tip_grafa = "pt",ylab = r'\textbf{$\Phi(G_n,k)$}', naslov = r'\textbf{ŠTEVILO KOPIJ $P_k$ V PLATONSKIH GRAFIH}')
nariši_graf(pt_fi_i, tip_grafa = "pt",ylab = r'\textbf{$\Phi_i(G_n,k)$}', naslov = r'\textbf{ŠTEVILO INDUCIRANIH KOPIJ $P_k$ V PLATONSKIH GRAFIH}')
nariši_graf(sr_fi, tip_grafa = "sr",ylab = r'\textbf{$\Phi(G_n,k)$}', naslov = r'\textbf{ŠTEVILO KOPIJ $P_k$ V SIERPINSKIH GRAFIH}')
nariši_graf(sr_fi_i, tip_grafa = "sr",ylab = r'\textbf{$\Phi_i(G_n,k)$}', naslov = r'\textbf{ŠTEVILO INDUCIRANIH KOPIJ $P_k$ V SIERPINSKIH GRAFIH}')
nariši_graf(clg_fi, tip_grafa = "clg",ylab = r'\textbf{$\Phi(G_n,k)$}', naslov = r'\textbf{ŠTEVILO KOPIJ $P_k$ V CLG GRAFIH}')
nariši_graf(clg_fi_i, tip_grafa = "clg",ylab = r'\textbf{$\Phi_i(G_n,k)$}', naslov = r'\textbf{ŠTEVILO INDUCIRANIH KOPIJ $P_k$ V CLG GRAFIH}')

prim1 = primerjalna_razpred(clg_fi,clg_fi_i, 4)
nariši_graf_primerjave(prim1, ylab = r'\textbf{$\Phi_i(G_n,k)$}', naslov=r'\textbf{PRIMERJAVA $\Phi(G,k)$ in $\Phi_i(G,k)$ za CLG$_7$}')



if os.path.exists("tabele.tex"):
    os.remove("tabele.tex")

with open("tabele.tex","w") as f:
    tabele =[hk_fi,hk_fi_i,pt_fi,pt_fi_i, sr_fi, sr_fi_i, clg_fi, clg_fi_i, prim1]
    f.write("povrsti so: hk_fi,hk_fi_i,pt_fi,pt_fi_i, sr_fi, sr_fi_i, clg_fi, clg_fi_i, prim"+"\n"*3)
    for t in tabele:
        print(t)
        lt = t.to_latex()
        f.write(lt+"\n"*3)



